import{c as k,u as se,r,j as e,T as z,a as T,m as ae,g as ie,h as te,G as re,R as $,Z as ne,f as ce,n as oe}from"./index-CpO6bAzs.js";import{P as m}from"./plus-DO9-gutA.js";import{C as le}from"./chevron-down-DpHtPZ0p.js";import{L as de}from"./layers-N9fiCyL7.js";const pe=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],B=k("database",pe);const ge=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],me=k("lightbulb",ge);const he=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],M=k("skull",he),ue=[{id:"SC-001",title:"CDVR Recording - Happy Path",category:"E2E",priority:"P1",type:"positive",requirement:"REQ-001",status:"generated",module:"CDVR Recording",steps:["Navigate to program guide","Select future program","Click Record","Verify recording scheduled","Verify playback after recording completes"],branchComplexity:82,edgeCoverage:70,regressionImpact:90,overlaps:["SC-002"]},{id:"SC-002",title:"CDVR Recording - Storage Full",category:"E2E",priority:"P1",type:"negative",requirement:"REQ-006",status:"generated",module:"Storage Management",steps:["Fill storage to 100%","Attempt new recording","Verify error message displayed","Verify manage storage option shown"],branchComplexity:55,edgeCoverage:85,regressionImpact:65,overlaps:["SC-001"]},{id:"SC-003",title:"Concurrent Recording Conflict",category:"Integration",priority:"P2",type:"negative",requirement:"REQ-003",status:"review",module:"Conflict Resolution",steps:["Schedule 2 overlapping recordings","Verify conflict notification","Select resolution option","Verify correct recording proceeds"],branchComplexity:92,edgeCoverage:40,regressionImpact:88,overlaps:[]},{id:"SC-004",title:"Trick Play on CDVR Content",category:"UI",priority:"P2",type:"positive",requirement:"REQ-002",status:"generated",module:"Playback & Trick Play",steps:["Play recorded content","Fast forward 2x, 4x, 8x","Rewind 2x, 4x, 8x","Pause and resume","Verify seek bar accuracy"],branchComplexity:68,edgeCoverage:55,regressionImpact:72,overlaps:[]},{id:"SC-005",title:"Cross-Device Recording Sync",category:"API",priority:"P1",type:"positive",requirement:"REQ-004",status:"generated",module:"Cross-Device Sync",steps:["Schedule recording on Device A","Verify recording appears on Device B","Delete recording on Device B","Verify deletion synced to Device A"],branchComplexity:75,edgeCoverage:60,regressionImpact:80,overlaps:[]},{id:"SC-006",title:"Parental Control on Recordings",category:"E2E",priority:"P2",type:"positive",requirement:"REQ-005",status:"review",module:"Parental Controls",steps:["Enable parental controls","Record restricted content","Attempt playback","Verify PIN prompt","Enter correct PIN and verify playback"],branchComplexity:45,edgeCoverage:72,regressionImpact:55,overlaps:[]},{id:"SC-007",title:"Recording API - Invalid Token",category:"Backend",priority:"P3",type:"negative",requirement:"REQ-001",status:"generated",module:"CDVR Recording",steps:["Send recording request with expired token","Verify 401 response","Verify error body format"],branchComplexity:30,edgeCoverage:90,regressionImpact:40,overlaps:[]},{id:"SC-008",title:"Storage Quota 80% Notification",category:"UI",priority:"P2",type:"positive",requirement:"REQ-006",status:"generated",module:"Storage Management",steps:["Fill storage to 79%","Add recording to cross 80%","Verify notification displayed","Verify notification content"],branchComplexity:38,edgeCoverage:78,regressionImpact:50,overlaps:["SC-002"]}],xe=[{id:"ET-001",title:"Network drop mid-recording schedule",type:"chaos",steps:["Begin recording schedule API call","Simulate network disconnect at 50% payload","Verify partial state rollback","Verify retry mechanism activates"]},{id:"ET-002",title:"Expired auth token during playback",type:"chaos",steps:["Start CDVR playback with valid token","Token expires mid-stream","Verify silent token refresh","Verify playback continues without interruption"]},{id:"ET-003",title:"Database timeout on conflict resolution",type:"chaos",steps:["Trigger concurrent recording conflict","Simulate DB response timeout (30s)","Verify user sees loading state","Verify graceful fallback after timeout"]},{id:"ET-004",title:"Storage write failure mid-recording",type:"chaos",steps:["Start recording successfully","Simulate disk write failure at 60%","Verify partial recording cleanup","Verify user notification of failure"]}],ye=[{id:"DB-001",name:"Channel Variants",entries:["ESPN HD","CNN","HBO Max","Discovery+","Spectrum News NY1","Fox Sports 1"]},{id:"DB-002",name:"Account Tiers",entries:["CDVR Unlimited","CDVR 200hr","Essential","Select Plus","Choice"]},{id:"DB-003",name:"Device Types",entries:["Roku Ultra","Apple TV 4K","Xumo Stream Box","Samsung Smart TV","Xbox Series X"]}],y={old:["Schedule 2 overlapping recordings","Verify conflict notification","Verify correct recording proceeds"],new:["Schedule 2 overlapping recordings","Verify conflict notification with priority indicator","Select resolution option (keep higher priority)","Verify correct recording proceeds","Verify cancelled recording notification sent"]},ve=[{icon:"ðŸŽ¯",text:"Boundary: Recording at exactly 200 hours limit",priority:"high"},{icon:"ðŸŒ",text:"Missing: Network interruption during recording",priority:"high"},{icon:"ðŸ”’",text:"Security: Unauthorized access to another user's recordings",priority:"medium"}],Q=["All","E2E","UI","Integration","Backend","API"];function Se({preFilter:v,onClearFilter:E}){const l=se(),[f,h]=r.useState(ue),[u,G]=r.useState("All"),[d,_]=r.useState(null),[j,F]=r.useState(!1),[b,U]=r.useState(!1),[w,R]=r.useState([]),[p,L]=r.useState(!1),[I,O]=r.useState(!1),[N,H]=r.useState(null),[x,D]=r.useState(null),[A,C]=r.useState(!1),[V,fe]=r.useState(ve);r.useEffect(()=>{v&&D(v)},[v]);const X=()=>{D(null),E&&E()},W=async()=>{C(!0),l.info("AI is generating scenarios from your requirements...");try{const a=JSON.parse(localStorage.getItem("vpt-docs")||"[]").filter(c=>c.status==="parsed");if(a.length===0){l.warning("No parsed documents found. Upload requirements in Document Hub first."),C(!1);return}const i=a.flatMap(c=>(c.aiRequirements||[]).map(t=>({id:t.id,title:t.title,description:t.description,risk:t.risk})));if(i.length===0){const c=a.map((t,ee)=>({id:`REQ-${String(ee+1).padStart(3,"0")}`,title:t.name,description:`Document with ${t.stories} stories and ${t.specs} specs. Testability: ${t.testability}%`,risk:t.testability<60?"high":t.testability<80?"medium":"low"}));i.push(...c)}const g=((await oe(i)).scenarios||[]).map((c,t)=>({...c,id:c.id||`SC-${String(f.length+t+1).padStart(3,"0")}`,status:"generated",module:c.requirement||"AI Generated",branchComplexity:c.edgeCoverage||70,overlaps:[]}));h(c=>[...c,...g]),l.success(`AI generated ${g.length} new scenarios`)}catch(s){console.error("AI scenario generation failed:",s),l.error(`AI generation failed: ${s.message}`)}finally{C(!1)}},n=p?[...f,...xe.map(s=>({...s,category:"E2E",priority:"P1",requirement:"REQ-003",status:"generated",module:"Conflict Resolution",branchComplexity:95,edgeCoverage:92,regressionImpact:88,overlaps:[]}))]:f,K=n.filter(s=>!(x&&s.module!==x||u!=="All"&&s.category!==u)),Z=Q.reduce((s,a)=>(s[a]=a==="All"?n.length:n.filter(i=>i.category===a).length,s),{}),J=[{req:"REQ-001",scenarios:2,coverage:85},{req:"REQ-002",scenarios:1,coverage:60},{req:"REQ-003",scenarios:1,coverage:45},{req:"REQ-004",scenarios:1,coverage:70},{req:"REQ-005",scenarios:1,coverage:75},{req:"REQ-006",scenarios:2,coverage:90}],S=s=>s>75?"var(--success)":s>50?"var(--warning)":"var(--danger)",P=s=>s>75?"var(--success)":s>50?"var(--warning)":"var(--danger)",Y=s=>s>75?"var(--success-light)":s>50?"var(--warning-light)":"var(--danger-light)",q=V.filter((s,a)=>!w.includes(a));return e.jsxs("div",{className:"scenario-generator",children:[x&&e.jsxs("div",{className:"module-filter-banner animate-in",children:[e.jsx(z,{size:14}),e.jsxs("span",{children:["Filtered by module: ",e.jsx("strong",{children:x})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:X,children:"Clear Filter Ã—"})]}),q.length>0&&e.jsxs("div",{className:"ai-suggestions-banner animate-in",children:[e.jsxs("div",{className:"banner-header",children:[e.jsx(me,{size:16})," AI Recommendations â€” ",q.length," high-value scenarios detected"]}),e.jsx("div",{className:"banner-items",children:V.map((s,a)=>!w.includes(a)&&e.jsxs("div",{className:"banner-suggestion",children:[e.jsx("span",{className:"banner-icon",children:s.icon}),e.jsx("span",{className:"banner-text",children:s.text}),e.jsx("span",{className:`badge badge-${s.priority==="high"?"danger":"warning"}`,children:s.priority}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{const i=`SC-${String(n.length+1).padStart(3,"0")}`;h(o=>[...o,{id:i,title:s.text,category:"E2E",priority:s.priority==="high"?"P1":"P2",type:"negative",requirement:"REQ-003",status:"generated",module:"CDVR Recording",steps:["AI-generated step 1","AI-generated step 2"],branchComplexity:70,edgeCoverage:80,regressionImpact:75,overlaps:[]}]),R(o=>[...o,a])},children:[e.jsx(m,{size:12})," Add"]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>R(i=>[...i,a]),children:"Dismiss"})]},a))})]}),e.jsxs("section",{className:"grid-4",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value animate-count",children:n.length}),e.jsx("div",{className:"stat-label",children:"Total Scenarios"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value animate-count",style:{color:"var(--success)"},children:n.filter(s=>s.type==="positive").length}),e.jsx("div",{className:"stat-label",children:"Positive"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value animate-count",style:{color:"var(--danger)"},children:n.filter(s=>s.type==="negative"||s.type==="chaos").length}),e.jsxs("div",{className:"stat-label",children:["Negative",p?" + Chaos":""]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{className:"stat-value animate-count",style:{color:"var(--info)"},children:[n.length>0?Math.round(n.reduce((s,a)=>s+(a.edgeCoverage||0),0)/n.length):0,"%"]}),e.jsx("div",{className:"stat-label",children:"Avg Coverage"})]})]}),e.jsxs("div",{className:"scenario-layout",children:[e.jsxs("section",{className:"card scenario-list-panel",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Test Scenarios"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("label",{className:`evil-twin-toggle ${p?"active":""}`,title:"Evil Twin Mode â€” generate chaotic edge cases",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:()=>L(!p)}),e.jsx(M,{size:14})," Evil Twin"]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>O(!I),children:[e.jsx(B,{size:14})," Data Bank"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:W,disabled:A,children:[e.jsx(T,{size:14})," ",A?"Generating...":"Generate More"]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{const s=`SC-${String(n.length+1).padStart(3,"0")}`;h(a=>[...a,{id:s,title:"New Manual Scenario",category:"E2E",priority:"P2",type:"positive",requirement:"REQ-001",status:"draft",module:"CDVR Recording",steps:["Step 1: Define action","Step 2: Verify result"],branchComplexity:50,edgeCoverage:50,regressionImpact:50,overlaps:[]}]),l.success(`${s} added â€” edit the steps in the expanded view`)},children:[e.jsx(m,{size:14})," Manual Add"]})]})]}),e.jsx("div",{className:"category-pills",role:"tablist",children:Q.map(s=>e.jsxs("button",{role:"tab",className:`category-pill ${u===s?"active":""}`,onClick:()=>G(s),"aria-selected":u===s,children:[s," ",e.jsx("span",{className:"pill-count",children:Z[s]})]},s))}),I&&e.jsxs("div",{className:"data-bank-panel animate-in",children:[e.jsxs("div",{className:"data-bank-header",children:[e.jsx(B,{size:14})," Parameterization Data Bank"]}),e.jsx("p",{className:"data-bank-desc",children:"Link data sets to scenarios so the same test runs against multiple inputs."}),e.jsx("div",{className:"data-bank-list",children:ye.map(s=>e.jsxs("div",{className:`data-bank-item ${N===s.id?"selected":""}`,onClick:()=>H(N===s.id?null:s.id),children:[e.jsxs("div",{className:"db-item-header",children:[e.jsx("span",{className:"db-item-name",children:s.name}),e.jsxs("span",{className:"badge badge-accent",children:[s.entries.length," entries"]})]}),N===s.id&&e.jsxs("div",{className:"db-entries",children:[s.entries.map((a,i)=>e.jsx("span",{className:"db-entry-chip",children:a},i)),e.jsxs("button",{className:"btn btn-sm btn-primary",style:{marginTop:"0.35rem"},onClick:()=>l.info(`Data set "${s.name}" linked to ${d||"selected scenario"}. ${s.entries.length} entries will be parameterized.`),children:[e.jsx(m,{size:10})," Link to Selected Scenario"]})]})]},s.id))})]}),e.jsx("div",{className:"scenario-list",role:"list",children:K.map(s=>e.jsxs("div",{className:`scenario-item ${s.type==="chaos"?"chaos-item":""}`,role:"listitem",children:[e.jsxs("div",{className:"scenario-header",onClick:()=>_(d===s.id?null:s.id),tabIndex:0,role:"button","aria-expanded":d===s.id,children:[d===s.id?e.jsx(le,{size:16}):e.jsx(ae,{size:16}),e.jsxs("div",{className:"scenario-info",children:[e.jsxs("div",{className:"scenario-top",children:[e.jsx("span",{className:"scenario-id",children:s.id}),e.jsx("span",{className:`badge badge-${s.category==="E2E"?"accent":s.category==="UI"?"info":s.category==="Backend"||s.category==="API"?"warning":"success"}`,children:s.category}),e.jsxs("span",{className:`badge ${s.type==="positive"?"badge-success":(s.type==="chaos","badge-danger")}`,children:[s.type==="positive"?e.jsx(ie,{size:10}):s.type==="chaos"?e.jsx(M,{size:10}):e.jsx(te,{size:10}),s.type]}),e.jsx("span",{className:"badge badge-accent",children:s.priority})]}),e.jsx("p",{className:"scenario-title",children:s.title}),e.jsxs("div",{className:"scenario-bottom",children:[e.jsxs("span",{className:"scenario-req",children:[e.jsx(re,{size:12})," ",s.requirement]}),s.branchComplexity&&e.jsxs("div",{className:"depth-indicators",children:[e.jsxs("span",{className:"depth-chip",title:"Branch complexity",style:{color:S(s.branchComplexity)},children:["ðŸŒ¿ ",s.branchComplexity]}),e.jsxs("span",{className:"depth-chip",title:"Edge case coverage",style:{color:S(s.edgeCoverage)},children:["âš¡ ",s.edgeCoverage]}),e.jsxs("span",{className:"depth-chip",title:"Regression impact",style:{color:S(s.regressionImpact)},children:["ðŸ”„ ",s.regressionImpact]})]})]}),s.overlaps&&s.overlaps.length>0&&e.jsxs("div",{className:"scenario-overlaps",children:[e.jsx(de,{size:11})," Overlaps with: ",s.overlaps.map(a=>e.jsx("span",{className:"overlap-link",children:a},a))]})]})]}),d===s.id&&e.jsxs("div",{className:"scenario-steps animate-in",children:[e.jsx("h4",{children:"Steps:"}),e.jsx("ol",{children:s.steps.map((a,i)=>e.jsx("li",{children:a},i))})]})]},s.id))})]}),e.jsxs("div",{className:"scenario-side-panels",children:[e.jsxs("section",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[e.jsx(z,{size:16})," Coverage Heatmap"]})}),e.jsxs("div",{className:"coverage-grid",role:"table",children:[e.jsxs("div",{className:"coverage-header",role:"row",children:[e.jsx("span",{children:"Requirement"}),e.jsx("span",{children:"Scenarios"}),e.jsx("span",{children:"Coverage"})]}),J.map(s=>e.jsxs("div",{className:"coverage-row clickable-row",role:"row",tabIndex:0,title:`Click to drill into ${s.req}`,style:{background:Y(s.coverage)},children:[e.jsx("span",{className:"coverage-req",children:s.req}),e.jsx("span",{children:s.scenarios}),e.jsxs("div",{className:"coverage-bar-wrap",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${s.coverage}%`,background:P(s.coverage)}})}),e.jsxs("span",{className:"coverage-pct",style:{color:P(s.coverage)},children:[s.coverage,"%"]})]})]},s.req))]})]}),e.jsxs("section",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx($,{size:16})," Scenario Diff"]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(!j),children:[j?"Hide":"Show"," Diff"]})]}),j&&e.jsxs("div",{className:"diff-viewer animate-in",children:[e.jsxs("div",{className:"diff-col diff-old",children:[e.jsx("h5",{children:"v1.0 (Previous)"}),y.old.map((s,a)=>e.jsx("div",{className:"diff-line",children:s},a))]}),e.jsxs("div",{className:"diff-col diff-new",children:[e.jsx("h5",{children:"v2.0 (Current)"}),y.new.map((s,a)=>{const i=!y.old.includes(s),o=y.old.some(g=>s.startsWith(g.substring(0,20))&&g!==s);return e.jsxs("div",{className:`diff-line ${i?"diff-added":""} ${o?"diff-modified":""}`,children:[i&&e.jsx(m,{size:12}),o&&e.jsx($,{size:12}),s]},a)})]})]})]}),e.jsxs("section",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx(T,{size:16})," Advanced Negatives"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>U(!b),children:[e.jsx(ne,{size:12})," ",b?"Hide":"Expand"]})]}),b&&e.jsxs("div",{className:"neg-expansion animate-in",children:[e.jsxs("h5",{children:[e.jsx(ce,{size:14})," Advanced Negative Paths"]}),[{icon:"â±",label:"Timeout: Recording API response exceeds 30s threshold"},{icon:"âš ï¸",label:"Partial Failure: Recording starts but storage write fails mid-stream"},{icon:"ðŸ”’",label:"Permission Denied: Expired subscription attempts recording"},{icon:"ðŸ’¥",label:"Boundary Overflow: 201st hour recording on full storage"},{icon:"ðŸ”Œ",label:"Network Drop: WiFi disconnect during cross-device sync"}].map((s,a)=>e.jsxs("div",{className:"neg-item",children:[e.jsx("span",{children:s.icon}),e.jsx("span",{children:s.label}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{const i=`SC-${String(n.length+1).padStart(3,"0")}`;h(o=>[...o,{id:i,title:s.label,category:"Backend",priority:"P2",type:"negative",requirement:"REQ-003",status:"generated",module:"CDVR Recording",steps:[s.label],branchComplexity:80,edgeCoverage:85,regressionImpact:70,overlaps:[]}]),l.success(`${i}: "${s.label}" added`)},children:e.jsx(m,{size:10})})]},a))]})]})]})]})]})}export{Se as default};
