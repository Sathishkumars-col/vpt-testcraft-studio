import{u as q,r as p,j as s,L as F,a as u,b as S,T as f,g as D,f as j,S as k,Z as G,e as O,F as P,l as $}from"./index-DOv-VC2m.js";function M(){const d=q(),[o,w]=p.useState([]),[c,z]=p.useState(null),[v,g]=p.useState(!1);p.useEffect(()=>{const e=JSON.parse(localStorage.getItem("vpt-docs")||"[]");w(e)},[]);const i=o.filter(e=>e.status==="parsed"),A=o.reduce((e,a)=>e+(a.stories||0),0),I=o.reduce((e,a)=>e+(a.specs||0),0),t=i.length>0?Math.round(i.reduce((e,a)=>e+(a.testability||0),0)/i.length):0,m=i.length>0?Math.round(i.reduce((e,a)=>e+(a.completeness||0),0)/i.length):0,h=i.length>0?Math.round(i.reduce((e,a)=>e+(a.ambiguity||0),0)/i.length):0,y=i.filter(e=>(e.testability||0)<60),n=i.flatMap(e=>e.aiRequirements||[]),x=i.flatMap(e=>e.aiIssues||[]),l=e=>e>80?"var(--success)":e>60?"var(--warning)":"var(--danger)",b=e=>e<25?"var(--success)":e<40?"var(--warning)":"var(--danger)",T=async()=>{if(i.length===0){d.warning("No parsed documents yet. Upload and parse documents in Document Hub first.");return}g(!0),d.info("AI is generating project summary...");try{const e=i.map(r=>({name:r.name,stories:r.stories,specs:r.specs,testability:r.testability,completeness:r.completeness,ambiguity:r.ambiguity,summary:r.aiSummary||"",requirements:(r.aiRequirements||[]).slice(0,5).map(N=>N.title),issues:(r.aiIssues||[]).slice(0,3).map(N=>N.text)})),C=(await $(`You are a senior QA Test Architect. Analyze this project's documents and provide a comprehensive project overview. Return JSON with these fields:
{
  "projectName": "<inferred project name>",
  "executiveSummary": "<3-4 sentence high-level summary>",
  "scope": "<what the project covers>",
  "keyFindings": ["<finding 1>", "<finding 2>", ...],
  "risks": [{"title": "<risk>", "severity": "high|medium|low", "mitigation": "<suggestion>"}],
  "recommendations": ["<recommendation 1>", "<recommendation 2>", ...],
  "testStrategy": "<recommended test approach in 2-3 sentences>",
  "readinessScore": <0-100 overall readiness>,
  "coverageGaps": ["<gap 1>", "<gap 2>", ...]
}
Only return valid JSON.`,JSON.stringify(e))).reply.replace(/```json\s*/g,"").replace(/```\s*/g,"").trim(),R=JSON.parse(C);z(R),d.success("Project overview generated")}catch(e){console.error("AI summary failed:",e),d.error(`AI summary failed: ${e.message}`)}finally{g(!1)}};return s.jsxs("div",{className:"project-overview",children:[s.jsxs("section",{className:"grid-4",style:{marginBottom:"1.5rem"},children:[s.jsxs("div",{className:"card stat-card",children:[s.jsx("div",{className:"stat-value animate-count",children:o.length}),s.jsx("div",{className:"stat-label",children:"Documents"})]}),s.jsxs("div",{className:"card stat-card",children:[s.jsx("div",{className:"stat-value animate-count",style:{color:"var(--success)"},children:A}),s.jsx("div",{className:"stat-label",children:"User Stories"})]}),s.jsxs("div",{className:"card stat-card",children:[s.jsx("div",{className:"stat-value animate-count",style:{color:"var(--warning)"},children:I}),s.jsx("div",{className:"stat-label",children:"Tech Specs"})]}),s.jsxs("div",{className:"card stat-card",children:[s.jsxs("div",{className:"stat-value animate-count",style:{color:l(t)},children:[t,"%"]}),s.jsx("div",{className:"stat-label",children:"Avg Testability"})]})]}),s.jsxs("div",{className:"po-generate-row",children:[s.jsx("button",{className:"btn btn-primary btn-lg",onClick:T,disabled:v,children:v?s.jsxs(s.Fragment,{children:[s.jsx(F,{size:16,className:"spin"})," Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(u,{size:16})," Generate AI Project Summary"]})}),i.length===0&&s.jsx("span",{className:"po-hint",children:"Upload documents in Document Hub first"})]}),s.jsxs("div",{className:"po-layout",children:[s.jsx("div",{className:"po-main",children:c?s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"card po-summary-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsxs("h3",{className:"card-title",children:[s.jsx(S,{size:16})," ",c.projectName||"Project Summary"]}),s.jsxs("div",{className:"po-readiness",children:[s.jsx("span",{className:"po-readiness-label",children:"Readiness"}),s.jsxs("span",{className:"po-readiness-score",style:{color:l(c.readinessScore||0)},children:[c.readinessScore||0,"%"]})]})]}),s.jsx("p",{className:"po-executive",children:c.executiveSummary}),s.jsxs("div",{className:"po-field",children:[s.jsx("span",{className:"po-field-label",children:"Scope:"})," ",c.scope]}),s.jsxs("div",{className:"po-field",children:[s.jsx("span",{className:"po-field-label",children:"Test Strategy:"})," ",c.testStrategy]})]}),s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(f,{size:16})," Key Findings"]})}),s.jsx("ul",{className:"po-list",children:(c.keyFindings||[]).map((e,a)=>s.jsxs("li",{children:[s.jsx(D,{size:13,className:"text-success"})," ",e]},a))})]}),s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(j,{size:16})," Risks"]})}),s.jsx("div",{className:"po-risks",children:(c.risks||[]).map((e,a)=>s.jsxs("div",{className:`po-risk-item severity-${e.severity}`,children:[s.jsxs("div",{className:"po-risk-header",children:[s.jsx("span",{className:"po-risk-title",children:e.title}),s.jsx("span",{className:`badge badge-${e.severity==="high"?"danger":e.severity==="medium"?"warning":"success"}`,children:e.severity})]}),s.jsxs("p",{className:"po-risk-mitigation",children:[s.jsx(k,{size:12})," ",e.mitigation]})]},a))})]}),(c.coverageGaps||[]).length>0&&s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(G,{size:16})," Coverage Gaps"]})}),s.jsx("ul",{className:"po-list po-gaps",children:c.coverageGaps.map((e,a)=>s.jsxs("li",{children:[s.jsx(j,{size:13,className:"text-warning"})," ",e]},a))})]}),s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(u,{size:16})," Recommendations"]})}),s.jsx("ul",{className:"po-list",children:(c.recommendations||[]).map((e,a)=>s.jsxs("li",{children:[s.jsx(u,{size:13,className:"text-accent"})," ",e]},a))})]})]}):s.jsxs("div",{className:"po-empty-state card",children:[s.jsx(S,{size:48}),s.jsx("h3",{children:"No Project Summary Yet"}),s.jsx("p",{children:'Click "Generate AI Project Summary" to create a comprehensive overview based on your uploaded documents and AI analysis.'})]})}),s.jsxs("div",{className:"po-sidebar",children:[s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(O,{size:16})," Quality Scores"]})}),s.jsxs("div",{className:"po-scores",children:[s.jsxs("div",{className:"po-score-row",children:[s.jsx("span",{children:"Testability"}),s.jsx("div",{className:"po-bar",children:s.jsx("div",{className:"po-bar-fill",style:{width:`${t}%`,background:l(t)}})}),s.jsxs("span",{style:{color:l(t)},children:[t,"%"]})]}),s.jsxs("div",{className:"po-score-row",children:[s.jsx("span",{children:"Completeness"}),s.jsx("div",{className:"po-bar",children:s.jsx("div",{className:"po-bar-fill",style:{width:`${m}%`,background:l(m)}})}),s.jsxs("span",{style:{color:l(m)},children:[m,"%"]})]}),s.jsxs("div",{className:"po-score-row",children:[s.jsx("span",{children:"Ambiguity"}),s.jsx("div",{className:"po-bar",children:s.jsx("div",{className:"po-bar-fill",style:{width:`${h}%`,background:b(h)}})}),s.jsxs("span",{style:{color:b(h)},children:[h,"%"]})]})]})]}),s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(P,{size:16})," Parsed Documents"]})}),s.jsx("div",{className:"po-doc-list",children:i.length>0?i.map(e=>s.jsxs("div",{className:"po-doc-item",children:[s.jsx("div",{className:"po-doc-name",children:e.name}),s.jsxs("div",{className:"po-doc-meta",children:[s.jsxs("span",{children:[e.stories," stories"]}),s.jsxs("span",{children:[e.specs," specs"]}),s.jsxs("span",{style:{color:l(e.testability||0)},children:[e.testability,"%"]})]}),e.aiSummary&&s.jsx("p",{className:"po-doc-summary",children:e.aiSummary})]},e.id)):s.jsx("p",{className:"po-empty-hint",children:"No parsed documents yet"})})]}),n.length>0&&s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(f,{size:16})," Extracted Requirements (",n.length,")"]})}),s.jsxs("div",{className:"po-req-list",children:[n.slice(0,15).map((e,a)=>s.jsxs("div",{className:"po-req-item",children:[s.jsx("span",{className:"po-req-id",children:e.id}),s.jsx("span",{className:"po-req-title",children:e.title}),s.jsx("span",{className:`badge badge-${e.risk==="high"?"danger":e.risk==="medium"?"warning":"success"}`,children:e.risk})]},a)),n.length>15&&s.jsxs("p",{className:"po-more",children:["+",n.length-15," more"]})]})]}),x.length>0&&s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(j,{size:16})," AI-Detected Issues (",x.length,")"]})}),s.jsx("div",{className:"po-issues-list",children:x.slice(0,8).map((e,a)=>s.jsxs("div",{className:"po-issue-item",children:[s.jsx(j,{size:12,className:"text-warning"}),s.jsx("span",{children:e.text})]},a))})]}),y.length>0&&s.jsxs("section",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h3",{className:"card-title",children:[s.jsx(k,{size:16})," High Risk Documents"]})}),s.jsx("div",{className:"po-doc-list",children:y.map(e=>s.jsxs("div",{className:"po-doc-item po-doc-risk",children:[s.jsx("div",{className:"po-doc-name",children:e.name}),s.jsxs("span",{className:"badge badge-danger",children:["Testability: ",e.testability,"%"]})]},e.id))})]})]})]})]})}export{M as default};
