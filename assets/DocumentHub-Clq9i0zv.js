import{c as E,u as as,r as n,j as e,X as R,G,f as W,R as q,S as ts,g as je,Z as ls,U as ye,a as M,F as fe,h as is,i as rs,k as ns}from"./index-DOv-VC2m.js";import{s as cs,a as os,b as ds}from"./sanitize-uP-gIDZP.js";import{T as A}from"./trash-2-BnfjC1M8.js";import{S as ms}from"./square-check-big-CvxN2Bvx.js";import{R as ve}from"./rotate-ccw-D7QikCdB.js";import{E as us}from"./eye-CQmJmb7b.js";import{C as hs}from"./clock-CAPsyJUM.js";const ps=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ne=E("archive",ps);const xs=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],gs=E("git-merge",xs);const bs=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],K=E("link",bs);const js=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],H=E("tag",js),Ce={Jira:"Authentication token expired â€” re-authenticate with Jira to retry",Confluence:"Page not found or access denied â€” check URL permissions",URL:"Connection timeout â€” the remote server did not respond",default:"Parsing failed â€” invalid document format or corrupted file"},ys=[{id:1,name:"CDVR Unlimited Requirements.pdf",type:"PDF",status:"parsed",stories:24,specs:18,uploaded:"2026-02-18",size:"2.4 MB",ambiguity:18,completeness:85,testability:92,parseProgress:100,tags:["cdvr"]},{id:2,name:"Pause Live Re-Architecture.docx",type:"Word",status:"parsing",stories:0,specs:0,uploaded:"2026-02-19",size:"1.8 MB",ambiguity:0,completeness:0,testability:0,parseProgress:62,tags:["pause-live"]},{id:3,name:"SMB CDVR Test Strategy",type:"Confluence",status:"parsed",stories:12,specs:8,uploaded:"2026-02-20",size:"â€”",ambiguity:32,completeness:72,testability:78,parseProgress:100,tags:["smb"]},{id:4,name:"STVA-5234: Buyflow Redesign",type:"Jira",status:"error",stories:0,specs:0,uploaded:"2026-02-20",size:"â€”",ambiguity:0,completeness:0,testability:0,parseProgress:0,errorReason:"Authentication token expired â€” re-authenticate with Jira to retry",tags:["buyflow"]}],fs=o=>{const r=o.split(".").pop().toLowerCase();return["pdf"].includes(r)?"PDF":["doc","docx"].includes(r)?"Word":["xls","xlsx"].includes(r)?"Excel":["csv"].includes(r)?"CSV":["txt"].includes(r)?"Text":"File"},vs=o=>o<1024?o+" B":o<1048576?(o/1024).toFixed(1)+" KB":(o/1048576).toFixed(1)+" MB",X=()=>new Date().toISOString().split("T")[0],u=(o,r)=>Math.floor(Math.random()*(r-o+1))+o,ke=[{id:1,reqA:"REQ-001",reqB:"REQ-003",desc:"REQ-001 allows 200hrs recording but REQ-003 limits concurrent recordings without specifying storage impact",severity:"high",aiSuggestion:'Add clause: "200hr limit applies to total stored content; concurrent recording limit is independent of storage quota"'},{id:2,reqA:"REQ-004",reqB:"REQ-005",desc:"Cross-device sync may bypass parental controls during sync delay window",severity:"medium",aiSuggestion:'Add requirement: "Parental control state must sync before content availability across devices"'}];function Ts(){const o=as(),[r,d]=n.useState(()=>{const s=localStorage.getItem("vpt-docs");return s?JSON.parse(s):[]}),[Se,$]=n.useState(!1),[h,Z]=n.useState(null),[B,Y]=n.useState(!1),[we,N]=n.useState(!1),[De,C]=n.useState(!1),[ee,se]=n.useState(""),[F,ae]=n.useState(""),[te]=n.useState("https://jira.charter.com/"),[U,k]=n.useState(""),[J,S]=n.useState(""),[p,g]=n.useState([]),[ze,w]=n.useState(!1),[le,ie]=n.useState(""),[b,x]=n.useState(()=>{const s=localStorage.getItem("vpt-docs-trash");return s?JSON.parse(s):[]}),[re,ne]=n.useState(!1),[ce,Te]=n.useState(ke),[oe,L]=n.useState(!1),O=n.useRef(null),P=n.useRef((()=>{const a=JSON.parse(localStorage.getItem("vpt-docs")||"[]").map(t=>t.id);return Math.max(0,...a,ys.length)+1})());n.useEffect(()=>{localStorage.setItem("vpt-docs",JSON.stringify(r)),localStorage.setItem("vpt-docs-initialized","true")},[r]),n.useEffect(()=>{localStorage.setItem("vpt-docs-trash",JSON.stringify(b))},[b]);const Q=s=>{d(a=>[s,...a]),P.current++},de=async(s,a)=>{let t=0;const l=setInterval(()=>{t=Math.min(t+3,90),d(i=>i.map(c=>c.id===s?{...c,parseProgress:t}:c))},500);try{const i=await ns(a);clearInterval(l);const c=i.analysis;d(I=>I.map(y=>y.id===s?{...y,status:"parsed",parseProgress:100,stories:c.stories||0,specs:c.specs||0,ambiguity:c.ambiguity||0,completeness:c.completeness||0,testability:c.testability||0,aiIssues:c.issues||[],aiRequirements:c.extractedRequirements||[],aiSummary:c.summary||""}:y)),o.success(`AI analysis complete for "${a.name}"`)}catch(i){clearInterval(l),console.warn("AI analysis failed, falling back to simulation:",i.message),D(s),o.info("AI unavailable â€” using simulated analysis")}},D=s=>{let a=0;const t=setInterval(()=>{a+=u(8,18),a>=100?(a=100,clearInterval(t),d(l=>l.map(i=>i.id===s?{...i,status:"parsed",parseProgress:100,stories:u(5,30),specs:u(3,20),ambiguity:u(8,40),completeness:u(60,95),testability:u(65,98)}:i))):d(l=>l.map(i=>i.id===s?{...i,parseProgress:Math.min(a,95)}:i))},400)},me=n.useRef({}),Ie=s=>{d(t=>t.map(l=>l.id===s?{...l,status:"parsing",parseProgress:0,errorReason:void 0}:l));const a=me.current[s];a?de(s,a):D(s)},V=s=>{s.forEach(a=>{d(t=>t.map(l=>l.id===a?{...l,status:"parsing",parseProgress:0,stories:0,specs:0,ambiguity:0,completeness:0,testability:0}:l)),D(a)})};n.useEffect(()=>{if(r.filter(t=>t.status==="parsing"&&t.parseProgress<100&&t.parseProgress>0).length===0)return;const a=setTimeout(()=>{d(t=>t.map(l=>{if(l.status==="parsing"&&l.parseProgress>0&&l.parseProgress<100){const i=l.parseProgress+u(3,8);return i>=100?{...l,status:"parsed",parseProgress:100,stories:u(5,30),specs:u(3,20),ambiguity:u(8,40),completeness:u(60,95),testability:u(65,98)}:{...l,parseProgress:Math.min(i,95)}}return l}))},1200);return()=>clearTimeout(a)},[r]);const Re=s=>{s.target.files?.length&&be(s.target.files),s.target.value=""},_=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?$(!0):s.type==="dragleave"&&$(!1)},Ae=s=>{s.preventDefault(),s.stopPropagation(),$(!1),s.dataTransfer.files?.length&&be(s.dataTransfer.files)},ue=()=>{const s=cs(ee);if(!s){k("Please enter a valid URL (http/https only)");return}const a=P.current,t=s.includes("confluence")||s.includes("wiki"),l=t?decodeURIComponent(s.split("/").pop()||"Confluence Page"):s.length>60?s.substring(0,57)+"...":s;Q({id:a,name:l,type:t?"Confluence":"URL",status:"parsing",stories:0,specs:0,uploaded:X(),size:"â€”",ambiguity:0,completeness:0,testability:0,parseProgress:5,tags:[]}),D(a),se(""),k(""),N(!1),document.getElementById("docs-table")?.scrollIntoView({behavior:"smooth"})},he=()=>{const s=os(F);if(!s){S("Format: PROJECT-1234 (e.g., STVA-5234)");return}const a=P.current;Q({id:a,name:`${s}: Jira Ticket`,type:"Jira",status:"parsing",stories:0,specs:0,uploaded:X(),size:"â€”",ambiguity:0,completeness:0,testability:0,parseProgress:5,tags:[]}),D(a),ae(""),S(""),C(!1),document.getElementById("docs-table")?.scrollIntoView({behavior:"smooth"})},Pe=s=>{const a=r.find(t=>t.id===s);d(t=>t.filter(l=>l.id!==s)),g(t=>t.filter(l=>l!==s)),a&&(x(t=>[{...a,deletedAt:new Date().toISOString()},...t]),o.undo(`"${a.name}" moved to trash`,()=>{x(t=>t.filter(l=>l.id!==a.id)),d(t=>[a,...t])}))},qe=()=>{const s=r.filter(t=>p.includes(t.id));d(t=>t.filter(l=>!p.includes(l.id))),g([]);const a=s.map(t=>({...t,deletedAt:new Date().toISOString()}));x(t=>[...a,...t]),o.undo(`${s.length} document(s) moved to trash`,()=>{x(t=>t.filter(l=>!s.some(i=>i.id===l.id))),d(t=>[...s,...t])})},Me=s=>{const a=b.find(i=>i.id===s);if(!a)return;const{deletedAt:t,...l}=a;x(i=>i.filter(c=>c.id!==s)),d(i=>[l,...i]),o.success(`"${l.name}" restored`)},Ee=s=>{x(a=>a.filter(t=>t.id!==s)),o.info("Permanently deleted")},$e=()=>{x([]),o.info("Trash emptied")},Be=async()=>{if(B){Y(!1);return}L(!0),Y(!0);try{const a=r.filter(i=>i.status==="parsed").flatMap(i=>(i.aiRequirements||[]).map(c=>({id:c.id,title:c.title,description:c.description})));if(a.length<2){o.info("Need at least 2 parsed documents with requirements to detect conflicts"),L(!1);return}const l=((await rs(a)).conflicts||[]).map((i,c)=>({id:c+1,reqA:i.reqA,reqB:i.reqB,desc:i.description,severity:i.severity,aiSuggestion:i.suggestion}));Te(l.length>0?l:ke),o.success(`AI found ${l.length} conflict(s)`)}catch(s){console.warn("AI conflict detection failed:",s.message),o.info("AI unavailable â€” showing cached conflicts")}finally{L(!1)}},Fe=()=>{V(p),g([])},pe=()=>{const s=ds(le);s&&(d(a=>a.map(t=>p.includes(t.id)?{...t,tags:[...new Set([...t.tags||[],s])]}:t)),ie(""),w(!1),g([]))},Ue=s=>g(a=>a.includes(s)?a.filter(t=>t!==s):[...a,s]),Je=()=>g(xe.map(s=>s.id)),Le=s=>s==="parsed"?e.jsx(je,{size:16,className:"text-success"}):s==="parsing"?e.jsx(hs,{size:16,className:"text-warning"}):e.jsx(W,{size:16,className:"text-danger"}),Oe=s=>{Z(a=>a===s?null:s),document.getElementById("docs-table")?.scrollIntoView({behavior:"smooth"})},xe=h?r.filter(s=>h==="documents"?!0:h==="stories"?s.stories>0:h==="specs"?s.specs>0:h==="linked"?["Confluence","Jira","URL"].includes(s.type):!0):r,[Qe,z]=n.useState(!1),[v,Ve]=n.useState(null),[_e,T]=n.useState(!1),[Ge,We]=n.useState(null),[m,Ke]=n.useState(null),ge=s=>{const a=s.replace(/\.[^.]+$/,"").replace(/[\s_]v?\d+(\.\d+)?$/i,"");return r.find(t=>t.name.replace(/\.[^.]+$/,"").replace(/[\s_]v?\d+(\.\d+)?$/i,"").toLowerCase()===a.toLowerCase()&&t.status==="parsed")},He=s=>{const a=ge(s.name);a&&(Ve({oldDoc:a,newFileName:s.name,changes:[{type:"modified",text:"REQ-001: Storage limit changed from 200hrs to 250hrs"},{type:"added",text:"REQ-007: New 4K recording support requirement added"},{type:"added",text:"REQ-008: Multi-profile recording preferences"},{type:"removed",text:"REQ-004 acceptance criteria #3 removed"}],affectedTests:["TC-001","TC-002","TC-003"],outOfDate:3}),z(!0))},Xe=s=>{We(s.name||s),Ke({ambiguity:{score:u(15,45),issues:['Line 12: "gracefully" is vague â€” define specific error handling','Line 28: "quickly" needs measurable threshold (e.g., <3s)']},completeness:{score:u(55,85),issues:["Missing success criteria for 3 requirements","No acceptance criteria for edge cases"]},testability:{score:u(60,90),issues:["2 requirements lack measurable outcomes"]},overall:u(50,80)}),T(!0)},be=s=>{Array.from(s).forEach(a=>{ge(a.name)?He(a):Xe(a);const l=P.current;Q({id:l,name:a.name,type:fs(a.name),status:"parsing",stories:0,specs:0,uploaded:X(),size:vs(a.size),ambiguity:0,completeness:0,testability:0,parseProgress:5,tags:[]}),me.current[l]=a,de(l,a)}),document.getElementById("docs-table")?.scrollIntoView({behavior:"smooth"})},Ze=r.reduce((s,a)=>s+a.stories,0),Ye=r.reduce((s,a)=>s+a.specs,0),es=r.filter(s=>["Confluence","Jira","URL"].includes(s.type)).length,j=s=>s>80?"var(--success)":s>60?"var(--warning)":"var(--danger)",f=s=>s>70?"var(--success)":s>50?"var(--warning)":"var(--danger)";return e.jsxs("div",{className:"document-hub",children:[e.jsx("input",{type:"file",ref:O,onChange:Re,accept:".pdf,.doc,.docx,.xlsx,.xls,.csv,.txt",multiple:!0,style:{display:"none"},"aria-hidden":"true"}),we&&e.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),role:"dialog","aria-modal":"true","aria-label":"Import from URL",children:e.jsxs("div",{className:"modal-card",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx(K,{size:18})," Import from URL"]}),e.jsx("button",{className:"modal-close",onClick:()=>{N(!1),k("")},"aria-label":"Close",children:e.jsx(R,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("label",{className:"modal-label",htmlFor:"url-input",children:"Document URL"}),e.jsx("input",{id:"url-input",type:"url",className:`modal-input ${U?"input-error":""}`,placeholder:"https://confluence.example.com/page/requirements",value:ee,onChange:s=>{se(s.target.value),k("")},onKeyDown:s=>s.key==="Enter"&&ue(),autoFocus:!0}),U&&e.jsx("span",{className:"modal-error",children:U}),e.jsx("p",{className:"modal-hint",children:"Supports Confluence pages, Google Docs, or any public URL with document content."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>{N(!1),k("")},children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:ue,children:[e.jsx(K,{size:14})," Import"]})]})]})}),De&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),role:"dialog","aria-modal":"true","aria-label":"Connect Jira",children:e.jsxs("div",{className:"modal-card",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx(G,{size:18})," Connect Jira"]}),e.jsx("button",{className:"modal-close",onClick:()=>{C(!1),S("")},"aria-label":"Close",children:e.jsx(R,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("label",{className:"modal-label",htmlFor:"jira-base",children:"Jira Base URL"}),e.jsx("input",{id:"jira-base",type:"url",className:"modal-input modal-input-disabled",value:te,readOnly:!0}),e.jsx("label",{className:"modal-label",htmlFor:"jira-ticket",style:{marginTop:"0.75rem"},children:"Ticket ID"}),e.jsx("input",{id:"jira-ticket",type:"text",className:`modal-input ${J?"input-error":""}`,placeholder:"STVA-5234",value:F,onChange:s=>{ae(s.target.value.toUpperCase()),S("")},onKeyDown:s=>s.key==="Enter"&&he(),autoFocus:!0}),J&&e.jsx("span",{className:"modal-error",children:J}),e.jsx("p",{className:"modal-hint",children:"Enter the Jira ticket ID to import requirements and acceptance criteria."}),e.jsxs("div",{className:"jira-preview",children:[e.jsx("span",{className:"jira-preview-label",children:"Will fetch from:"}),e.jsxs("code",{children:[te,"browse/",F||"PROJECT-ID"]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>{C(!1),S("")},children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:he,children:[e.jsx(G,{size:14})," Connect"]})]})]})}),ze&&e.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),role:"dialog","aria-modal":"true","aria-label":"Tag documents",children:e.jsxs("div",{className:"modal-card",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx(H,{size:18})," Tag ",p.length," Documents"]}),e.jsx("button",{className:"modal-close",onClick:()=>w(!1),"aria-label":"Close",children:e.jsx(R,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("label",{className:"modal-label",htmlFor:"tag-input",children:"Tag Name"}),e.jsx("input",{id:"tag-input",type:"text",className:"modal-input",placeholder:"e.g., sprint-22, regression, cdvr",value:le,onChange:s=>ie(s.target.value),onKeyDown:s=>s.key==="Enter"&&pe(),autoFocus:!0})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:pe,children:[e.jsx(H,{size:14})," Apply Tag"]})]})]})}),Qe&&v&&e.jsx("div",{className:"modal-overlay",onClick:()=>z(!1),role:"dialog","aria-modal":"true","aria-label":"Version diff analysis",children:e.jsxs("div",{className:"modal-card modal-wide",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx(gs,{size:18})," Version Diff Analysis"]}),e.jsx("button",{className:"modal-close",onClick:()=>z(!1),"aria-label":"Close",children:e.jsx(R,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"diff-summary",children:[e.jsxs("span",{className:"badge badge-info",children:["Updating: ",v.oldDoc.name]}),e.jsxs("span",{className:"badge badge-accent",children:["â†’ ",v.newFileName]})]}),e.jsx("div",{className:"diff-changes-list",children:v.changes.map((s,a)=>e.jsxs("div",{className:`diff-change-item diff-${s.type}`,children:[e.jsx("span",{className:"diff-type-badge",children:s.type==="added"?"+":s.type==="removed"?"âˆ’":"~"}),e.jsx("span",{children:s.text})]},a))}),e.jsxs("div",{className:"diff-impact",children:[e.jsx(W,{size:14}),e.jsxs("span",{children:[v.outOfDate," test cases are now out of date: ",v.affectedTests.join(", ")]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>z(!1),children:"Dismiss"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>z(!1),children:[e.jsx(q,{size:14})," Update & Re-generate Tests"]})]})]})}),_e&&m&&e.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),role:"dialog","aria-modal":"true","aria-label":"Quality gate",children:e.jsxs("div",{className:"modal-card modal-wide",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx(ts,{size:18})," Pre-Parse Quality Gate"]}),e.jsx("button",{className:"modal-close",onClick:()=>T(!1),"aria-label":"Close",children:e.jsx(R,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{className:"modal-hint",style:{marginBottom:"0.75rem"},children:['AI scored "',Ge,'" before parsing:']}),e.jsxs("div",{className:"quality-gate-grid",children:[e.jsxs("div",{className:"qg-score",children:[e.jsx("div",{className:"qg-circle",style:{borderColor:f(100-m.ambiguity.score)},children:e.jsxs("span",{style:{color:f(100-m.ambiguity.score)},children:[m.ambiguity.score,"%"]})}),e.jsx("span",{className:"qg-label",children:"Ambiguity"}),e.jsx("ul",{className:"qg-issues",children:m.ambiguity.issues.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{className:"qg-score",children:[e.jsx("div",{className:"qg-circle",style:{borderColor:f(m.completeness.score)},children:e.jsxs("span",{style:{color:f(m.completeness.score)},children:[m.completeness.score,"%"]})}),e.jsx("span",{className:"qg-label",children:"Completeness"}),e.jsx("ul",{className:"qg-issues",children:m.completeness.issues.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsxs("div",{className:"qg-score",children:[e.jsx("div",{className:"qg-circle",style:{borderColor:f(m.testability.score)},children:e.jsxs("span",{style:{color:f(m.testability.score)},children:[m.testability.score,"%"]})}),e.jsx("span",{className:"qg-label",children:"Testability"}),e.jsx("ul",{className:"qg-issues",children:m.testability.issues.map((s,a)=>e.jsx("li",{children:s},a))})]})]}),e.jsxs("div",{className:"qg-overall",children:[e.jsx("span",{children:"Overall Quality:"}),e.jsxs("span",{className:"qg-overall-score",style:{color:f(m.overall)},children:[m.overall,"%"]}),m.overall<60&&e.jsx("span",{className:"badge badge-danger",children:"Below threshold â€” consider revising"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>T(!1),children:"Parse Anyway"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>T(!1),children:[e.jsx(je,{size:14})," Acknowledge & Continue"]})]})]})}),e.jsxs("div",{className:"impact-banner animate-in",children:[e.jsx(ls,{size:14}),e.jsx("span",{children:"Live Impact: Editing REQ-003 affects"}),e.jsxs("span",{className:"impact-chip",children:[e.jsx(q,{size:11})," 3 scenarios"]}),e.jsx("span",{className:"impact-chip",children:"ðŸ§ª 7 test cases"}),e.jsx("span",{className:"impact-chip danger-chip",children:"ðŸ“‰ -12% coverage"})]}),e.jsx("section",{className:"grid-4",style:{marginBottom:"1.5rem"},children:[{filter:"documents",value:r.length,label:"Documents Ingested",color:""},{filter:"stories",value:Ze,label:"User Stories Extracted",color:"var(--success)"},{filter:"specs",value:Ye,label:"Technical Specs",color:"var(--warning)"},{filter:"linked",value:es,label:"Linked Sources",color:"var(--info)"}].map(s=>e.jsxs("button",{className:`card stat-card stat-card-clickable ${h===s.filter?"stat-active":""}`,onClick:()=>Oe(s.filter),"aria-pressed":h===s.filter,children:[e.jsx("div",{className:"stat-value animate-count",style:s.color?{color:s.color}:{},children:s.value}),e.jsx("div",{className:"stat-label",children:s.label})]},s.filter))}),e.jsxs("section",{className:`drop-zone card ${Se?"drag-active":""}`,onDragEnter:_,onDragLeave:_,onDragOver:_,onDrop:Ae,onClick:()=>O.current?.click(),role:"region","aria-label":"Document upload area",children:[e.jsx(ye,{size:40,className:"drop-icon","aria-hidden":"true"}),e.jsx("h3",{children:"Drop documents here or click to browse"}),e.jsx("p",{children:"Supports PDF, Word, Confluence links, Jira tickets"}),e.jsxs("div",{className:"drop-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:s=>{s.stopPropagation(),O.current?.click()},children:[e.jsx(ye,{size:16})," Upload Files"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:s=>{s.stopPropagation(),N(!0)},children:[e.jsx(K,{size:16})," Import from URL"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:s=>{s.stopPropagation(),C(!0)},children:[e.jsx(G,{size:16})," Connect Jira"]})]})]}),e.jsxs("section",{className:"card",id:"docs-table",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:["Ingested Documents",h&&e.jsxs("span",{className:"filter-badge",children:[h," ",e.jsx("button",{className:"filter-clear",onClick:()=>Z(null),children:"Ã—"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",flexWrap:"wrap"},children:[p.length>0&&e.jsxs("div",{className:"bulk-actions animate-in",children:[e.jsxs("span",{className:"badge badge-accent",children:[p.length," selected"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:Fe,children:[e.jsx(q,{size:12})," Re-parse"]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>w(!0),children:[e.jsx(H,{size:12})," Tag"]}),e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:qe,children:[e.jsx(A,{size:12})," Delete"]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>g([]),children:"Clear"})]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:Je,children:[e.jsx(ms,{size:14})," Select All"]}),e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>{const s=[...r];d([]),g([]),x(a=>[...s.map(t=>({...t,deletedAt:new Date().toISOString()})),...a]),o.undo(`${s.length} document(s) moved to trash`,()=>{x(a=>a.filter(t=>!s.some(l=>l.id===t.id))),d(s)})},children:[e.jsx(A,{size:14})," Delete All"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{const s=r.filter(a=>a.status!=="parsed");if(s.length===0){o.info("All documents are already parsed");return}V(s.map(a=>a.id))},children:[e.jsx(M,{size:14})," Parse All with AI"]}),b.length>0&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>ne(!re),children:[e.jsx(Ne,{size:14})," Trash (",b.length,")"]})]})]}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{"aria-label":"Ingested documents list",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"32px"}}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Stories"}),e.jsx("th",{children:"Specs"}),e.jsx("th",{children:"Quality Score"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:xe.map(s=>e.jsxs("tr",{className:p.includes(s.id)?"row-selected":"",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:p.includes(s.id),onChange:()=>Ue(s.id),"aria-label":`Select ${s.name}`})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(fe,{size:16}),e.jsxs("div",{children:[e.jsx("div",{children:s.name}),s.tags?.length>0&&e.jsx("div",{className:"doc-tags",children:s.tags.map(a=>e.jsx("span",{className:"doc-tag",children:a},a))})]})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-accent",children:s.type})}),e.jsx("td",{children:e.jsxs("div",{className:"status-cell",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:[Le(s.status),e.jsx("span",{children:s.status})]}),s.status==="parsing"&&e.jsxs("div",{className:"parse-progress",children:[e.jsx("div",{className:"parse-progress-bar",children:e.jsx("div",{className:"parse-progress-fill",style:{width:`${s.parseProgress}%`}})}),e.jsxs("span",{className:"parse-pct",children:[s.parseProgress,"%"]})]}),s.status==="error"&&e.jsxs("div",{className:"error-detail",children:[e.jsx("span",{className:"error-reason",children:s.errorReason||Ce[s.type]||Ce.default}),e.jsxs("button",{className:"btn btn-sm btn-primary retry-btn",onClick:()=>Ie(s.id),children:[e.jsx(ve,{size:12})," Retry"]})]})]})}),e.jsx("td",{children:s.stories||"â€”"}),e.jsx("td",{children:s.specs||"â€”"}),e.jsx("td",{children:s.status==="parsed"?e.jsxs("div",{className:"quality-scores",children:[e.jsxs("div",{className:"mini-score",title:`Ambiguity: ${s.ambiguity}% (lower is better)`,children:[e.jsx("span",{className:"mini-label",children:"AMB"}),e.jsx("div",{className:"mini-bar",children:e.jsx("div",{className:"mini-fill",style:{width:`${s.ambiguity}%`,background:s.ambiguity<25?"var(--success)":"var(--danger)"}})}),e.jsxs("span",{style:{color:s.ambiguity<25?"var(--success)":"var(--danger)"},children:[s.ambiguity,"%"]})]}),e.jsxs("div",{className:"mini-score",title:`Completeness: ${s.completeness}%`,children:[e.jsx("span",{className:"mini-label",children:"CMP"}),e.jsx("div",{className:"mini-bar",children:e.jsx("div",{className:"mini-fill",style:{width:`${s.completeness}%`,background:j(s.completeness)}})}),e.jsxs("span",{style:{color:j(s.completeness)},children:[s.completeness,"%"]})]}),e.jsxs("div",{className:"mini-score",title:`Testability: ${s.testability}%`,children:[e.jsx("span",{className:"mini-label",children:"TST"}),e.jsx("div",{className:"mini-bar",children:e.jsx("div",{className:"mini-fill",style:{width:`${s.testability}%`,background:j(s.testability)}})}),e.jsxs("span",{style:{color:j(s.testability)},children:[s.testability,"%"]})]})]}):e.jsx("span",{className:"text-muted",children:"â€”"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary","aria-label":`View ${s.name}`,children:e.jsx(us,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary","aria-label":`Re-parse ${s.name}`,onClick:()=>V([s.id]),children:e.jsx(q,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary","aria-label":`Delete ${s.name}`,onClick:()=>Pe(s.id),children:e.jsx(A,{size:14})})]})})]},s.id))})]})})]}),re&&b.length>0&&e.jsxs("section",{className:"card animate-in",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx(Ne,{size:16})," Recently Deleted (",b.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:$e,children:[e.jsx(A,{size:12})," Empty Trash"]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ne(!1),children:"Close"})]})]}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{"aria-label":"Recently deleted documents",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Deleted"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(fe,{size:16}),e.jsx("span",{children:s.name})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-accent",children:s.type})}),e.jsx("td",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:s.deletedAt?new Date(s.deletedAt).toLocaleDateString():"â€”"}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>Me(s.id),children:[e.jsx(ve,{size:12})," Restore"]}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>Ee(s.id),children:e.jsx(A,{size:12})})]})})]},s.id))})]})})]}),r.filter(s=>s.status==="parsed").length>0&&e.jsxs("section",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx(M,{size:16})," Document Summary"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",fontSize:"0.72rem"},children:[e.jsx("span",{className:"legend-dot",style:{background:"var(--success)"}})," High",e.jsx("span",{className:"legend-dot",style:{background:"var(--warning)"}})," Medium",e.jsx("span",{className:"legend-dot",style:{background:"var(--danger)"}})," Low"]})]}),e.jsxs("div",{className:"doc-summary-viz",role:"img","aria-label":"Document summary bubble visualization",children:[e.jsxs("div",{className:"doc-summary-center",style:{borderColor:j(Math.round(r.filter(s=>s.status==="parsed").reduce((s,a)=>s+a.testability,0)/r.filter(s=>s.status==="parsed").length))},children:[e.jsxs("span",{className:"doc-summary-center-score",style:{color:j(Math.round(r.filter(s=>s.status==="parsed").reduce((s,a)=>s+a.testability,0)/r.filter(s=>s.status==="parsed").length))},children:[Math.round(r.filter(s=>s.status==="parsed").reduce((s,a)=>s+a.testability,0)/r.filter(s=>s.status==="parsed").length),"%"]}),e.jsx("span",{className:"doc-summary-center-label",children:"Overall Score"}),e.jsxs("span",{className:"doc-summary-center-count",children:[r.filter(s=>s.status==="parsed").length," docs"]})]}),r.filter(s=>s.status==="parsed").map((s,a,t)=>{const l=2*Math.PI*a/t.length-Math.PI/2,i=t.length<=4?140:t.length<=8?160:180,c=Math.cos(l)*i,I=Math.sin(l)*i,y=s.testability,ss=s.name.replace(/\.[^.]+$/,"").substring(0,20)+(s.name.length>24?"â€¦":"");return e.jsxs("div",{className:"doc-summary-bubble",style:{transform:`translate(${c}px, ${I}px)`,borderColor:j(y)},title:`${s.name}
Testability: ${y}%
Stories: ${s.stories} | Specs: ${s.specs}`,children:[e.jsxs("span",{className:"doc-summary-bubble-score",style:{color:j(y)},children:[y,"%"]}),e.jsx("span",{className:"doc-summary-bubble-label",children:ss}),e.jsxs("span",{className:"doc-summary-bubble-meta",children:[s.stories,"S / ",s.specs,"T"]})]},s.id)}),e.jsx("svg",{className:"doc-summary-lines",viewBox:"-250 -250 500 500",children:r.filter(s=>s.status==="parsed").map((s,a,t)=>{const l=2*Math.PI*a/t.length-Math.PI/2,i=t.length<=4?140:t.length<=8?160:180,c=Math.cos(l)*i,I=Math.sin(l)*i;return e.jsx("line",{x1:"0",y1:"0",x2:c,y2:I,stroke:"var(--border)",strokeWidth:"1",strokeDasharray:"4 3",opacity:"0.5"},s.id)})})]})]}),e.jsxs("section",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:[e.jsx(W,{size:16})," Conflict Detector"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:Be,disabled:oe,children:[e.jsx(M,{size:14})," ",oe?"Scanning...":B?"Hide":"Scan"," Conflicts (",ce.length,")"]})]}),B&&e.jsx("div",{className:"conflict-list animate-in",children:ce.map(s=>e.jsxs("div",{className:`conflict-item severity-${s.severity}`,children:[e.jsxs("div",{className:"conflict-header",children:[e.jsxs("div",{className:"conflict-reqs",children:[e.jsx("span",{className:"badge badge-danger",children:s.reqA}),e.jsx(is,{size:14}),e.jsx("span",{className:"badge badge-danger",children:s.reqB})]}),e.jsx("span",{className:`badge badge-${s.severity==="high"?"danger":"warning"}`,children:s.severity})]}),e.jsx("p",{className:"conflict-desc",children:s.desc}),e.jsxs("div",{className:"conflict-suggestion",children:[e.jsx(M,{size:13}),e.jsxs("div",{children:[e.jsx("strong",{children:"AI Suggestion:"}),e.jsx("p",{children:s.aiSuggestion}),e.jsx("button",{className:"btn btn-sm btn-success",style:{marginTop:"0.35rem"},children:"Apply Fix"})]})]})]},s.id))})]})]})}export{Ts as default};
